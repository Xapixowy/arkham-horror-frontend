<div class="character-page">
  <div class="character">
    <div class="character__column">
      <div class="character__image">
        @if (character()?.image_path) {
          <img [ngSrc]="character()?.image_path!" [alt]="'_CharacterPage.Character image' | transloco" fill priority/>
        } @else {
          <app-img-placeholder size="100%" shape="square"/>
        }
      </div>
      <h1 class="character__name">
        {{ character()?.name }}
      </h1>
      <div class="character-page__divider"></div>
      @if (character()?.skills) {
        <div class="character__skills">
          @for (skill of character()?.skills; track $index) {
            <div class="character__skill">
              <h2 class="character__skill__name">
                {{ skill.name }}
              </h2>
              <div class="character__skill__description" [innerHTML]="skill.description"></div>
            </div>
          }
        </div>
        <div class="character-page__divider character-page__divider--skills"></div>
      }
    </div>
    <div class="character__column">
      <form class="character__form" [formGroup]="form">
        <div class="character__status">
          <div class="character__status__label">
            {{ '_CharacterPage.Sanity' | transloco }}
          </div>
          <div class="character__status__input">
            <app-button-icon-only icon="tablerMinus" (onClick)="onSanityDecrease()"/>
            <div class="character__status__input__value character__status__input__value--sanity"
                 [ngClass]="sanityInputClasses()">
              {{ playerStatus.sanity() || 0 }}
            </div>
            <app-button-icon-only icon="tablerPlus" (onClick)="onSanityIncrease()"/>
          </div>
        </div>
        <div class="character__status">
        <span class="character__status__label">
          {{ '_CharacterPage.Endurance' | transloco }}
        </span>
          <div class="character__status__input">
            <app-button-icon-only icon="tablerMinus" (onClick)="onEnduranceDecrease()"/>
            <div class="character__status__input__value character__status__input__value--endurance"
                 [ngClass]="enduranceInputClasses()">
              {{ playerStatus.endurance() || 0 }}
            </div>
            <app-button-icon-only icon="tablerPlus" (onClick)="onEnduranceIncrease()"/>
          </div>
        </div>
        <div class="character-page__divider"></div>
        @if (attributeSliderConfigs.speedSneak()) {
          <div class="character__attribute">
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.speedSneak()!.firstAttribute.label | transloco }}
            </div>
            <app-attribute-slider [config]="attributeSliderConfigs.speedSneak()!" [noLabels]="true"/>
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.speedSneak()!.secondAttribute.label | transloco }}
            </div>
          </div>
          <div class="character-page__divider"></div>
        }
        @if (attributeSliderConfigs.prowessWill()) {
          <div class="character__attribute">
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.prowessWill()!.firstAttribute.label | transloco }}
            </div>
            <app-attribute-slider [config]="attributeSliderConfigs.prowessWill()!" [noLabels]="true"/>
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.prowessWill()!.secondAttribute.label | transloco }}
            </div>
          </div>
          <div class="character-page__divider"></div>
        }
        @if (attributeSliderConfigs.knowledgeLuck()) {
          <div class="character__attribute">
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.knowledgeLuck()!.firstAttribute.label | transloco }}
            </div>
            <app-attribute-slider [config]="attributeSliderConfigs.knowledgeLuck()!" [noLabels]="true"/>
            <div class="character__attribute__label">
              {{ attributeSliderConfigs.knowledgeLuck()!.secondAttribute.label | transloco }}
            </div>
          </div>
          <div class="character-page__divider"></div>
        }
        <div class="character__concentration">
          <span>{{ '_CharacterPage.Concentration' | transloco }}:</span>
          <span>{{ character()?.concentration }}</span>
        </div>
      </form>
    </div>
  </div>

  <div class="game-layout-modal" [class.game-layout-modal--shown]="isCharacterDetailsShown()">
    <div class="game-layout-modal__header">
      <h2>{{ '_CharacterPage.Character details' | transloco }}</h2>
      <div class="game-layout-modal__header__close" (click)="onCloseCharacterDetails()">
        <ng-icon name="tablerX"/>
      </div>
    </div>
    <div class="game-layout-modal__content">
      @if (character()?.expansion) {
        <div class="game-layout-modal__section">
          <div class="game-layout-modal__section__header">
            <ng-icon name="tablerPuzzle"/>
            <span>{{ '_CharacterPage.Expansion' | transloco }}</span>
          </div>
          <div class="game-layout-modal__section__content">
            {{ '_Expansion.' + character()!.expansion | transloco }}
          </div>
        </div>
      }
      @if (character()?.profession) {
        <div class="game-layout-modal__section">
          <div class="game-layout-modal__section__header">
            <ng-icon name="tablerBriefcase2"/>
            <span>{{ '_CharacterPage.Profession' | transloco }}</span>
          </div>
          <div class="game-layout-modal__section__content">
            {{ character()!.profession }}
          </div>
        </div>
      }
      @if (character()?.starting_location) {
        <div class="game-layout-modal__section">
          <div class="game-layout-modal__section__header">
            <ng-icon name="tablerPin"/>
            <span>{{ '_CharacterPage.Starting location' | transloco }}</span>
          </div>
          <div class="game-layout-modal__section__content">
            {{ character()!.starting_location }}
          </div>
        </div>
      }
      @if (character()?.equipment) {
        <div class="game-layout-modal__section">
          <div class="game-layout-modal__section__header">
            <ng-icon name="tablerBackpack"/>
            <span>{{ '_CharacterPage.Starting equipment' | transloco }}</span>
          </div>
          <div class="game-layout-modal__section__content">
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Money' | transloco }}:</span>
              <span>{{ character()!.equipment.money }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Clues' | transloco }}:</span>
              <span>{{ character()!.equipment.clues }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Random common items' | transloco }}:</span>
              <span>{{ character()!.equipment.random.common_items }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Random unique items' | transloco }}:</span>
              <span>{{ character()!.equipment.random.unique_items }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Random spells' | transloco }}:</span>
              <span>{{ character()!.equipment.random.spells }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Random abilities' | transloco }}:</span>
              <span>{{ character()!.equipment.random.abilities }}</span>
            </p>
            <p class="game-layout-modal__equipment">
              <span>{{ '_CharacterPage.Random allies' | transloco }}:</span>
              <span>{{ character()!.equipment.random.allies }}</span>
            </p>
          </div>
        </div>
      }
      @if (character()?.description) {
        <div class="game-layout-modal__section">
          <div class="game-layout-modal__section__header">
            <ng-icon name="tablerScript"/>
            <span>{{ '_CharacterPage.Description' | transloco }}</span>
          </div>
          <div class="game-layout-modal__section__content game-layout-modal__section__content--description"
               [innerHTML]="character()!.description"></div>
        </div>
      }
    </div>
  </div>
</div>
